---
const { slug } = Astro.props;
---

<astro-analytics data-slug={slug}></astro-analytics>
<script async>
class AstroAnalytics extends HTMLElement {
  constructor() {
    super();
    (async () => {
      await fetch('/api/page-view', {
        method: 'POST',
        body: JSON.stringify({ date: new Date(), slug: this.dataset.slug }),
      });
    })();
  }
}
customElements.define('astro-analytics', AstroAnalytics);
</script>
