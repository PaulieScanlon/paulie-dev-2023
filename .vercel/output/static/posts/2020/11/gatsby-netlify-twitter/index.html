<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="/prism-dracula.css" rel="stylesheet"><title>Paul Scanlon | Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog</title><link rel="canonical" href="https://paulie.dev/posts/2020/11/gatsby-netlify-twitter/"><meta name="description" content=""><meta name="image" content="https://paulie.devhttps://res.cloudinary.com/www-paulie-dev/image/upload/v1605613346/paulie.dev/2020/11/gatsby-netlify-twitterjpg_ok1k0q.jpg"><meta name="image:alt" content=""><meta name="keywords" content="React, Gatsby, JavaScript, TypeScript, Flow, Styled Components, Theme UI, Tailwind, Jest, Enzyme, React Testing Libary, Node.js, Fauna, Jamstack, Component Library, Serverless Functions"><!-- Facebook --><meta property="og:type"><meta property="og:title" content="Paul Scanlon | Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog"><meta property="og:url" content="https://paulie.dev/posts/2020/11/gatsby-netlify-twitter/"><meta property="og:description" content=""><meta property="og:image" content="https://paulie.devhttps://res.cloudinary.com/www-paulie-dev/image/upload/v1605613346/paulie.dev/2020/11/gatsby-netlify-twitterjpg_ok1k0q.jpg"><meta property="og:image:alt" content=""><!-- Twitter --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Paul Scanlon | Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog"><meta name="twitter:url" content="https://paulie.dev/posts/2020/11/gatsby-netlify-twitter/"><meta name="twitter:description" content=""><meta name="twitter:image" content="https://paulie.devhttps://res.cloudinary.com/www-paulie-dev/image/upload/v1605613346/paulie.dev/2020/11/gatsby-netlify-twitterjpg_ok1k0q.jpg"><meta name="twitter:image:alt" content=""><!-- Favicons --><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-react-helmet="true"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" data-react-helmet="true"><!-- Web mention --><link rel="webmention" href="https://webmention.io/paulie.dev/webmention"><link rel="pingback" href="https://webmention.io/paulie.dev/xmlrpc"><!-- <style type='text/css'>
      lite-youtube {
        border: 1px solid red !important;
      }
    </style> --><link rel="stylesheet" href="/_astro/about.3f802ac7.css" /><script type="module" src="/_astro/hoisted.5a594899.js"></script><style type="text/css">.twitter-tweet:not(.twitter-tweet-rendered){padding:var(--tc-padding, 1em);border:1px solid var(--tc-border-color, #cfd9de)}.twitter-tweet:not(.twitter-tweet-rendered)>:first-child{margin-top:0}.twitter-tweet:not(.twitter-tweet-rendered)>:last-child{margin-bottom:0}
</style><style type="text/css">lite-vimeo{font-size:10px;background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer}lite-vimeo:after{content:"";display:block;padding-bottom:56.25%}lite-vimeo>iframe{width:100%;height:100%;position:absolute;top:0;left:0}lite-vimeo>.ltv-playbtn{width:6.5em;height:4em;background:rgba(23,35,34,.75);z-index:1;opacity:.8;border-radius:.5em;transition:all .2s cubic-bezier(0,0,.2,1);outline:0;border:0;cursor:pointer}lite-vimeo:hover>.ltv-playbtn{background-color:#00adef;background-color:var(--ltv-color, rgb(0, 173, 239));opacity:1}lite-vimeo>.ltv-playbtn:before{content:"";border-style:solid;border-width:10px 0 10px 20px;border-color:transparent transparent transparent #fff}lite-vimeo>.ltv-playbtn,lite-vimeo>.ltv-playbtn:before{position:absolute;top:50%;left:50%;transform:translate3d(-50%,-50%,0)}lite-vimeo.ltv-activated{cursor:unset}lite-vimeo.ltv-activated:before,lite-vimeo.ltv-activated>.ltv-playbtn{opacity:0;pointer-events:none}
</style><style type="text/css">lite-youtube{background-color:#000;position:relative;display:block;contain:content;background-position:center center;background-size:cover;cursor:pointer;max-width:720px}lite-youtube:before{content:"";display:block;position:absolute;top:0;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==);background-position:top;background-repeat:repeat-x;height:60px;padding-bottom:50px;width:100%;transition:all .2s cubic-bezier(0,0,.2,1)}lite-youtube:after{content:"";display:block;padding-bottom:56.25%}lite-youtube>iframe{width:100%;height:100%;position:absolute;top:0;left:0;border:0}lite-youtube>.lty-playbtn{width:68px;height:48px;position:absolute;cursor:pointer;transform:translate3d(-50%,-50%,0);top:50%;left:50%;z-index:1;background-color:transparent;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 68 48"><path fill="%23f00" fill-opacity="0.8" d="M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z"></path><path d="M 45,24 27,14 27,34" fill="%23fff"></path></svg>');filter:grayscale(100%);transition:filter .1s cubic-bezier(0,0,.2,1);border:none}lite-youtube:hover>.lty-playbtn,lite-youtube .lty-playbtn:focus{filter:none}lite-youtube.lyt-activated{cursor:unset}lite-youtube.lyt-activated:before,lite-youtube.lyt-activated>.lty-playbtn{opacity:0;pointer-events:none}.lyt-visually-hidden{clip:rect(0 0 0 0);-webkit-clip-path:inset(50%);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}
</style><script src="/_astro/Tweet.astro_astro_type_script_index_0_lang.4828da08.js" type="module"></script><script src="/_astro/Vimeo.astro_astro_type_script_index_0_lang.9174df0e.js" type="module"></script><script src="/_astro/YouTube.astro_astro_type_script_index_0_lang.33baca9c.js" type="module"></script></head><body class="prose max-w-none bg-brand-background"><header class="sticky top-0 z-40 w-full backdrop-blur border-b border-b-brand-outline flex-none bg-brand-background lg:bg-transparent"><div class="max-w-8xl mx-auto"><div class="py-4 mx-4 lg:px-8 lg:mx-0"><div class="relative flex items-center"><a class="flex items-center" href="/" aria-current="page"><span class="sr-only">Paul Scanlon's Site</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 202 48" height="40"><g><circle class="fill-brand-background" cx="23" cy="24" r="23"></circle><path class="fill-brand-tertiary" d="M5,24c0-9.9,8.1-18,18-18l0,0V1C17.2,1,12.3,2.9,7.9,6.6C-1.7,15-2.7,29.5,5.6,39.1l3.8-3.3
          C6.7,32.6,5,28.5,5,24z"></path><path class="fill-brand-secondary" d="M23,42c-5.4,0-10.3-2.4-13.6-6.2l-3.8,3.3c0.8,0.9,1.7,1.8,2.6,2.5c9.7,8.2,24.2,6.9,32.4-2.8l-3.8-3.2
          C33.5,39.5,28.5,42,23,42z"></path><path class="fill-brand-primary" d="M23,1v5c9.9,0,18,8.1,18,18c0,4.4-1.6,8.4-4.2,11.6l3.8,3.2c3.7-4.4,5.4-9,5.4-14.8C46,11.3,35.7,1,23,1z"></path><path class="fill-brand-text" d="M18.9,16.9H24c1.1,0,2.1,0.2,2.8,0.6s1.3,0.9,1.7,1.6s0.5,1.4,0.5,2.3s-0.2,1.6-0.5,2.3s-0.9,1.2-1.6,1.6
          s-1.7,0.6-2.8,0.6h-2.4v6h-2.7V16.9z M23.9,23.5c0.8,0,1.4-0.2,1.8-0.6s0.6-0.9,0.6-1.5c0-0.7-0.2-1.2-0.6-1.6s-1-0.6-1.7-0.6
          h-2.3v4.2H23.9z"></path></g><g><path class="fill-brand-text" d="M60.3,17.9h5.1c1.1,0,2.1,0.2,2.8,0.6s1.3,0.9,1.7,1.6s0.5,1.4,0.5,2.3s-0.2,1.6-0.5,2.3s-0.9,1.2-1.6,1.6
          s-1.7,0.6-2.8,0.6h-2.4v6h-2.7V17.9z M65.3,24.5c0.8,0,1.4-0.2,1.8-0.6s0.6-0.9,0.6-1.5c0-0.7-0.2-1.2-0.6-1.6s-1-0.6-1.7-0.6
          h-2.3v4.2H65.3z"></path><path class="fill-brand-text" d="M80.4,22.4c0.9,0.7,1.3,1.9,1.3,3.6v6.8h-2.6v-1c-0.4,0.4-0.9,0.7-1.6,1s-1.3,0.3-2,0.3
          c-1.2,0-2.1-0.3-2.7-0.9c-0.6-0.6-0.9-1.4-0.9-2.3c0-0.8,0.3-1.5,0.8-2s1.2-1,2.2-1.3s2.1-0.4,3.4-0.4h0.8c-0.1-1-0.3-1.7-0.7-2.1
          s-1-0.6-1.8-0.6c-0.5,0-1.1,0.1-1.6,0.4s-1.1,0.6-1.5,1.1l-1.4-1.8c0.7-0.6,1.5-1.1,2.3-1.5s1.6-0.5,2.4-0.5
          C78.4,21.3,79.5,21.7,80.4,22.4z M78.4,30.3c0.5-0.5,0.7-1.3,0.8-2.4h-0.5c-1.4,0-2.4,0.1-3,0.4s-0.9,0.8-0.9,1.4
          c0,0.4,0.2,0.8,0.5,1s0.8,0.3,1.3,0.3C77.3,31.1,78,30.8,78.4,30.3z"></path><path class="fill-brand-text" d="M85.3,32.2c-0.6-0.7-1-1.9-1-3.6v-7H87v7c0,0.8,0.1,1.5,0.4,1.9s0.7,0.6,1.2,0.6c0.4,0,0.9-0.1,1.2-0.4
          s0.7-0.6,0.9-1s0.3-0.9,0.3-1.4v-6.7h2.7V31c0,0.5,0,0.8,0,1.1c0,0.2,0.1,0.5,0.2,0.7h-2.6c-0.1-0.2-0.2-0.4-0.2-0.6s0-0.4,0-0.7
          c-0.3,0.5-0.8,1-1.3,1.3s-1.1,0.5-1.7,0.5C86.9,33.3,86,33,85.3,32.2z"></path><path class="fill-brand-text" d="M96.8,32.9v-2.1h3.1v-12h-2.9v-2.1h5.6v14.1h3v2.1H96.8z"></path><path class="fill-brand-text" d="M128.6,25.6c0.6,0.4,1,0.9,1.2,1.4s0.4,1.1,0.4,1.7c0,0.8-0.2,1.5-0.6,2.2s-0.9,1.3-1.7,1.7
          s-1.8,0.6-3,0.6c-1.9,0-3.6-0.7-5.1-2.1l1.2-2l0,0l0,0c1.2,1.2,2.5,1.8,4.1,1.8c0.8,0,1.3-0.2,1.7-0.5s0.6-0.9,0.6-1.6
          c0-0.4-0.1-0.7-0.3-1s-0.5-0.6-0.9-0.9s-1-0.6-1.8-0.9c-1.4-0.6-2.4-1.3-3-2s-0.9-1.6-0.9-2.6c0-0.7,0.2-1.4,0.6-2s1-1.1,1.7-1.4
          s1.5-0.5,2.4-0.5c1,0,1.8,0.2,2.6,0.5s1.4,0.8,2.1,1.5l-1.3,1.9l0,0c0,0,0,0,0,0c-0.4-0.6-0.8-1-1.4-1.3s-1.2-0.4-1.9-0.4
          c-0.4,0-0.8,0.1-1.1,0.2s-0.6,0.4-0.7,0.6s-0.2,0.5-0.2,0.8c0,0.4,0.1,0.7,0.3,0.9s0.5,0.5,0.9,0.8s1.1,0.6,1.9,1
          C127.3,24.7,128.1,25.1,128.6,25.6z M120.9,29C120.9,29,120.9,29,120.9,29l0.1,0l0,0.1C120.9,29.1,120.9,29,120.9,29z M121.3,29.2
          C121.3,29.2,121.3,29.2,121.3,29.2c0,0-0.1,0-0.1,0s-0.1-0.1-0.1-0.1l0-0.1L121.3,29.2L121.3,29.2z M128.2,21.4
          C128.2,21.4,128.2,21.4,128.2,21.4c0,0,0.1,0,0.1,0s0.1,0.1,0.1,0.1l0,0.1L128.2,21.4L128.2,21.4z M128.6,21.6
          C128.6,21.6,128.6,21.6,128.6,21.6c0,0-0.1,0-0.2-0.1l0.1-0.1C128.5,21.5,128.6,21.6,128.6,21.6z"></path><path class="fill-brand-text" d="M139.2,30.6c0.5-0.2,0.9-0.6,1.4-1.1l1.6,1.8c-0.6,0.7-1.3,1.2-2,1.5s-1.5,0.5-2.4,0.5
          c-1.1,0-2.1-0.3-2.9-0.8c-0.9-0.5-1.5-1.2-2-2.1s-0.7-1.9-0.7-3c0-1.1,0.2-2.1,0.7-3s1.2-1.6,2-2.1s1.8-0.8,2.9-0.8
          c0.9,0,1.8,0.2,2.6,0.6s1.4,0.9,1.9,1.6l-1.5,1.8l0,0c0,0,0,0,0,0c-0.3-0.6-0.7-1-1.2-1.3s-1.1-0.4-1.8-0.4c-0.5,0-1,0.2-1.5,0.5
          s-0.8,0.8-1.1,1.3s-0.4,1.2-0.4,2c0,0.7,0.1,1.3,0.4,1.9s0.6,0.9,1,1.2s1,0.4,1.5,0.4C138.2,30.9,138.7,30.8,139.2,30.6z
           M140.4,25.3C140.4,25.3,140.4,25.3,140.4,25.3c0.1,0,0.1,0,0.3,0.1l0,0.1L140.4,25.3L140.4,25.3z M140.8,25.5
          C140.8,25.5,140.8,25.5,140.8,25.5c0,0-0.1,0-0.1-0.1l0.1-0.1C140.8,25.4,140.8,25.5,140.8,25.5z"></path><path class="fill-brand-text" d="M152.4,22.4c0.9,0.7,1.3,1.9,1.3,3.6v6.8h-2.6v-1c-0.4,0.4-0.9,0.7-1.6,1s-1.3,0.3-2,0.3
          c-1.2,0-2.1-0.3-2.7-0.9c-0.6-0.6-0.9-1.4-0.9-2.3c0-0.8,0.3-1.5,0.8-2s1.2-1,2.2-1.3s2.1-0.4,3.4-0.4h0.8c-0.1-1-0.3-1.7-0.7-2.1
          s-1-0.6-1.8-0.6c-0.5,0-1.1,0.1-1.6,0.4s-1.1,0.6-1.5,1.1l-1.4-1.8c0.7-0.6,1.5-1.1,2.3-1.5s1.6-0.5,2.4-0.5
          C150.4,21.3,151.5,21.7,152.4,22.4z M150.4,30.3c0.5-0.5,0.7-1.3,0.8-2.4h-0.5c-1.4,0-2.4,0.1-3,0.4s-0.9,0.8-0.9,1.4
          c0,0.4,0.2,0.8,0.5,1s0.8,0.3,1.3,0.3C149.3,31.1,150,30.8,150.4,30.3z"></path><path class="fill-brand-text" d="M156.6,21.7h2.7v1.1c0.4-0.4,0.9-0.8,1.4-1s1.1-0.4,1.8-0.4c1.1,0,1.9,0.4,2.5,1.1s1,1.9,1,3.5v6.8h-2.7
          v-6.8c0-0.8-0.2-1.5-0.5-1.9s-0.8-0.6-1.4-0.6c-0.4,0-0.7,0.1-1.1,0.2s-0.6,0.4-0.8,0.7s-0.3,0.7-0.3,1.1v7.2h-2.7V21.7z"></path><path class="fill-brand-text" d="M168.8,32.9v-2.1h3.1v-12h-2.9v-2.1h5.6v14.1h3v2.1H168.8z"></path><path class="fill-brand-text" d="M182.5,32.5c-0.8-0.5-1.5-1.2-1.9-2.1s-0.7-1.9-0.7-3.1c0-1.1,0.2-2.1,0.7-3s1.1-1.6,1.9-2.1
          s1.7-0.8,2.7-0.8s1.9,0.3,2.7,0.8s1.5,1.2,1.9,2.1s0.7,1.9,0.7,3c0,1.2-0.2,2.2-0.7,3.1s-1.1,1.6-1.9,2.1
          c-0.8,0.5-1.7,0.8-2.7,0.8S183.3,33,182.5,32.5z M186.6,30.6c0.4-0.3,0.7-0.8,0.9-1.3s0.3-1.2,0.3-2c0-0.8-0.1-1.4-0.3-2
          s-0.5-1-0.9-1.3s-0.9-0.4-1.4-0.4c-0.5,0-1,0.1-1.3,0.4s-0.7,0.7-0.9,1.3s-0.3,1.2-0.3,2c0,0.8,0.1,1.4,0.3,2s0.5,1,0.9,1.3
          s0.8,0.5,1.4,0.5S186.2,30.9,186.6,30.6z"></path><path class="fill-brand-text" d="M192.6,21.7h2.7v1.1c0.4-0.4,0.9-0.8,1.4-1s1.1-0.4,1.8-0.4c1.1,0,1.9,0.4,2.5,1.1s1,1.9,1,3.5v6.8h-2.7
          v-6.8c0-0.8-0.2-1.5-0.5-1.9s-0.8-0.6-1.4-0.6c-0.4,0-0.7,0.1-1.1,0.2s-0.6,0.4-0.8,0.7s-0.3,0.7-0.3,1.1v7.2h-2.7V21.7z"></path></g></svg></a><div class="relative flex lg:hidden items-center ml-auto"><button id="menu" class="not-prose ml-auto flex items-center justify-center text-brand-text"><span class="sr-only">Navigation</span><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path id="path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg></button></div></div></div></div></header><div class="relative"><div id="lightbox" aria-label="lightbox" tab-index="0" role="button" class="z-20 top-0 left-0 w-screen h-screen bg-black opacity-80"></div><div class="max-w-8xl mx-auto px-4 sm:px-6 md:px-8"><div id="sidebar" class="lg:block fixed z-30 inset-0 top-[3.8125rem] transition-all duration-300 right-auto w-[14.5rem] pb-10 px-6 overflow-y-auto border-r border-r-brand-outline bg-brand-background lg:left-[max(0px,calc(50%-45rem))]"><div class="pt-10 pb-4"></div><div class="relative"><ul class="flex flex-col gap-2 m-0 p-0"><li class="m-0 p-0 list-none"><a href="/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z"></path></svg>Home</a></li><li class="m-0 p-0 list-none"><a href="/about/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z"></path></svg>About</a></li><li class="m-0 p-0 list-none"><a href="/articles/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5.566 4.657A4.505 4.505 0 016.75 4.5h10.5c.41 0 .806.055 1.183.157A3 3 0 0015.75 3h-7.5a3 3 0 00-2.684 1.657zM2.25 12a3 3 0 013-3h13.5a3 3 0 013 3v6a3 3 0 01-3 3H5.25a3 3 0 01-3-3v-6zM5.25 7.5c-.41 0-.806.055-1.184.157A3 3 0 016.75 6h10.5a3 3 0 012.683 1.657A4.505 4.505 0 0018.75 7.5H5.25z"></path></svg>Articles</a></li><li class="m-0 p-0 list-none"><a href="/demos/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006"></path></svg>Demos</a></li><li class="m-0 p-0 list-none"><a href="/opensource/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11.25 5.337c0-.355-.186-.676-.401-.959a1.647 1.647 0 01-.349-1.003c0-1.036 1.007-1.875 2.25-1.875S15 2.34 15 3.375c0 .369-.128.713-.349 1.003-.215.283-.401.604-.401.959 0 .332.278.598.61.578 1.91-.114 3.79-.342 5.632-.676a.75.75 0 01.878.645 49.17 49.17 0 01.376 5.452.657.657 0 01-.66.664c-.354 0-.675-.186-.958-.401a1.647 1.647 0 00-1.003-.349c-1.035 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401.31 0 .557.262.534.571a48.774 48.774 0 01-.595 4.845.75.75 0 01-.61.61c-1.82.317-3.673.533-5.555.642a.58.58 0 01-.611-.581c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.035-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959a.641.641 0 01-.658.643 49.118 49.118 0 01-4.708-.36.75.75 0 01-.645-.878c.293-1.614.504-3.257.629-4.924A.53.53 0 005.337 15c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.036 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.369 0 .713.128 1.003.349.283.215.604.401.959.401a.656.656 0 00.659-.663 47.703 47.703 0 00-.31-4.82.75.75 0 01.83-.832c1.343.155 2.703.254 4.077.294a.64.64 0 00.657-.642z"></path></svg>Open-source</a></li><li class="m-0 p-0 list-none"><a href="/posts/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21.731 2.269a2.625 2.625 0 00-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 000-3.712zM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 00-1.32 2.214l-.8 2.685a.75.75 0 00.933.933l2.685-.8a5.25 5.25 0 002.214-1.32L19.513 8.2z"></path></svg>Posts</a></li><li class="m-0 p-0 list-none"><a href="/streams/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 4.5a3 3 0 00-3 3v9a3 3 0 003 3h8.25a3 3 0 003-3v-9a3 3 0 00-3-3H4.5zM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06z"></path></svg>Streams</a></li><li class="m-0 p-0 list-none"><a href="/dashboard/" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 hover:text-brand-text text-slate-300"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18.375 2.25c-1.035 0-1.875.84-1.875 1.875v15.75c0 1.035.84 1.875 1.875 1.875h.75c1.035 0 1.875-.84 1.875-1.875V4.125c0-1.036-.84-1.875-1.875-1.875h-.75zM9.75 8.625c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-.75a1.875 1.875 0 01-1.875-1.875V8.625zM3 13.125c0-1.036.84-1.875 1.875-1.875h.75c1.036 0 1.875.84 1.875 1.875v6.75c0 1.035-.84 1.875-1.875 1.875h-.75A1.875 1.875 0 013 19.875v-6.75z"></path></svg>Dashboard</a></li></ul><hr class="border border-brand-outline my-8"><ul class="flex flex-col gap-2 m-0 p-0"><li class="m-0 p-0 list-none"><a href="https://x.com/PaulieScanlon" target="_blank" rel="noreferrer me" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 text-slate-400 hover:text-brand-text"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>X</a></li><li class="m-0 p-0 list-none"><a href="https://github.com/PaulieScanlon" target="_blank" rel="noreferrer me" class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 text-slate-400 hover:text-brand-text"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M11.88,0.6C5.5,0.6,0.3,5.8,0.3,12.18c0,5.44,3.78,10.05,8.86,11.23c0-0.12-0.12-0.35-0.12-0.59V20.8c-0.47,0-1.3,0-1.42,0c-0.83,0-1.54-0.35-1.89-0.95c-0.35-0.71-0.47-1.77-1.42-2.48C4.08,17.14,4.2,16.9,4.55,16.9c0.59,0.12,1.06,0.59,1.54,1.18c0.47,0.59,0.71,0.71,1.54,0.71c0.47,0,1.06,0,1.65-0.12c0.35-0.83,0.83-1.54,1.54-1.89c-3.9-0.35-5.67-2.36-5.67-4.96c0-1.18,0.47-2.25,1.3-3.19c-0.35-0.59-0.71-2.48,0-3.19c1.77,0,2.84,1.18,3.07,1.42c0.83-0.35,1.77-0.47,2.84-0.47s2.01,0.12,2.84,0.47c0.24-0.35,1.3-1.42,3.07-1.42c0.71,0.71,0.35,2.6,0.12,3.55c0.83,0.95,1.3,2.01,1.3,3.07c0,2.6-1.89,4.49-5.67,4.96c1.06,0.59,1.89,2.13,1.89,3.31v2.6c0,0.12,0,0.12,0,0.24c4.49-1.54,7.8-5.91,7.8-10.99C23.46,5.8,18.26,0.6,11.88,0.6z"></path></svg>GitHub</a></li><li class="m-0 p-0 list-none"><a href="https://linkedin.com/in/PaulieScanlon" target="_blank" rel="noreferrer " class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 text-slate-400 hover:text-brand-text"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21.4,0.64H2.72c-1.14,0-2.02,0.88-2.02,2.02v18.55c0,1.26,0.88,2.15,2.02,2.15h18.55c1.14,0,2.02-0.88,2.02-2.02V2.66C23.42,1.52,22.53,0.64,21.4,0.64z M7.89,19.19H4.86V9.48h3.03C7.89,9.48,7.89,19.19,7.89,19.19z M6.38,8.09c-1.01,0-1.77-0.76-1.77-1.77s0.76-1.89,1.77-1.89s1.77,0.76,1.77,1.77S7.26,8.09,6.38,8.09z M19.25,19.19h-3.03v-4.67c0-1.14,0-2.65-1.64-2.65s-1.77,1.26-1.77,2.52v4.8H9.79V9.48h2.9v1.26l0,0c0.38-0.76,1.39-1.64,2.9-1.64c3.03,0,3.66,2.02,3.66,4.67C19.25,13.89,19.25,19.19,19.25,19.19z"></path></svg>LinkedIn</a></li><li class="m-0 p-0 list-none"><a href="mailto:pauliescanlon@gmail.com" target="_blank" rel="noreferrer " class="not-prose inline-flex items-center gap-3 rounded-full px-3 py-2 border-transparent hover:bg-brand-surface border hover:border-brand-outline transition-colors duration-300 text-slate-400 hover:text-brand-text"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M2.35,3.18c-0.95,0-1.79,0.83-1.79,1.79v14.06c0,0.95,0.83,1.79,1.79,1.79h19.31c0.95,0,1.79-0.83,1.79-1.79V4.97c0-0.95-0.83-1.79-1.79-1.79h1.07H2.35z M4.73,4.97h14.54L12,10.33L4.73,4.97z M3.18,7.11L12,13.55l8.82-6.44v11.92H3.18V7.11z"></path></svg>Email</a></li></ul></div></div><main class="lg:pl-[14.5rem] pb-16"><section class="mx-auto pt-6 max-w-none xl:ml-0 xl:mr-[15.5rem] xl:pr-16"><article class="max-w-none min-h-[calc(100vh-19rem)]"><time class="text-xs font-bold text-brand-primary">Nov 17, 2020</time><h1>Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog</h1><p>Apologies in advance for the rather long-winded blog title but as it suggests in this post i‚Äôm going to explain how you
can use <a href="https://www.netlify.com/products/functions/">Netlify Functions</a> to access your Twitter profile data using the
<a href="https://developer.twitter.com/en/docs/twitter-api/early-access">Twitter v2 API</a> and display it on your Gatsby blog.</p>
<h2 id="a-rather-unique-requirement">A rather unique requirement</h2>
<p>This might be a specific to me but I wanted to solve a little problem I was having with my ‚Äúdigital footprint‚Äù. As you
can see I have this blog: <a href="https://paulie.dev/">https://paulie.dev</a> and a commercial portfolio:
<a href="https://www.pauliescanlon.io/">https://www.pauliescanlon.io</a></p>
<p>Both sites are built on top of my Gatsby theme: <a href="https://gatsby-theme-terminal.netlify.app/">gatsby-theme-terminal</a>
which is Open source and can be found on my <a href="https://github.com/PaulieScanlon/gatsby-theme-terminal">GitHub</a></p>
<p>Using a Gatsby Theme solves one of my issues as I‚Äôm able to have two sites that look and work pretty much the same way
and any changes I make to the theme are inherited by both my sites. It‚Äôs kind of like managing your own multi brand
design system, but just for yourself.</p>
<p>There was one other problem though. ü§î</p>
<p>I wanted both sites to have the same ‚Äúintro‚Äù section, but every time I made a change to one I had to make the same
change to the other site to ensure they were both displaying the same intro text.</p>
<p>This might be fine if I weren‚Äôt a developer but doing something twice is one time too many IMO.</p>
<p>It was also a little frustrating because I also wanted my Twitter profile description to be in sync with both the sites
so, again another place to remember to update my personal blurb.</p>
<p>One option I considered would have been to hook up a Content Management System, and this would have been fine and it
would have kept both my sites in sync but it wouldn‚Äôt have been able to update my Twitter profile blurb‚Ä¶</p>
<p>So, I‚Äôve decided to reverse engineer the Twitter API and use that as a CMS to populate both my sites. The idea is quite
simple. I‚Äôll use the Twitter profile description as though it were a field from a CMS. Naturally any changes I make to
this will appear on my Twitter profile and below is how I pull that same info into both of my sites.</p>
<h2 id="demo">Demo</h2>
<p>Here‚Äôs what I‚Äôll be showing you how to build:</p>
<ul>
<li>App / API <a href="https://gatsby-netlify-twitter.netlify.app/">https://gatsby-netlify-twitter.netlify.app</a></li>
<li>GitHub repo
<a href="https://github.com/PaulieScanlon/gatsby-netlify-twitter">https://github.com/PaulieScanlon/gatsby-netlify-twitter</a></li>
</ul>
<p>‚Ä¶ but the actual API I use for my blog and site is here:
<a href="https://paulie-api.netlify.app/">https://paulie-api.netlify.app</a></p>
<h2 id="tech">Tech</h2>
<h3 id="netlify-functions">Netlify Functions</h3>
<p>‚ÄúPower your site without managing servers‚Äù is how Netlify describe Functions and for all intents and purposes thats
exactly what they are. Similar to how you might create an <a href="https://expressjs.com/">Express</a> app and deploy it somewhere
but without the hassle of having to setup server side environments and more crucially any really dweeby server uptime
monitoring.</p>
<h3 id="twitter-api-v2">Twitter API v2</h3>
<p>A set of endpoints that can be used to get data from Twitter. Any Twitter requests must be done server side and use a
set of keys and tokens. You can‚Äôt unfortunately hit the Twitter API from the browser so we need a ‚Äúserver‚Äù or as
mentioned above, a Netlify Function</p>
<p>Using both of the above i‚Äôve made my own API endpoint which goes off and hits the Twitter API and returns my Profile
information which I can then display in the intro section of my blog and site. I‚Äôve deployed this API to Netlify and
it‚Äôs completely de-coupled from either of my sites but will return data which can be fetched from client side ‚Äúfetch‚Äù
request from within my site and blog. That url again is here:
<a href="https://paulie-api.netlify.app/">https://paulie-api.netlify.app</a></p>
<h2 id="before-we-start">Before we start</h2>
<p>Before we get started there‚Äôs a couple of things you‚Äôll need to have in place.</p>
<h3 id="twitter-api-v2-1">Twitter API v2</h3>
<p>Apply for access to the <a href="https://developer.twitter.com/en/products/twitter-api">Twitter API</a>. This is quite a lengthy
process so strap in and also bookmark this post as it might take a few days for Twitter to accept your application.</p>
<p>Once you have access you can head over to the <a href="https://developer.twitter.com/en/portal/dashboard">Developer Portal</a> and
create a new project, and within the project you can create an ‚Äúapp‚Äù, I called mine ‚Äúpaulie-api‚Äù.</p>
<p>In here you‚Äôll find all the API keys and tokens required to access the Twitter API. Make a note of them somewhere as
we‚Äôll be using them later.</p>
<h3 id="netlify-cli">Netlify CLI</h3>
<p>To run Netlify Functions we‚Äôll be using <code>netlify dev</code> rather than <code>gatsby develop</code> or <code>yarn develop</code> so you‚Äôll need to
install the <a href="https://docs.netlify.com/cli/get-started/">Netlify CLI</a></p>
<h2 id="the-build">The Build</h2>
<p>In order to develop you own API I found it easiest to have some kind of ‚Äúsite‚Äù running at the same time which will
access the API endpoint and render the response on the page. In the demo repo you‚Äôll see i‚Äôve set up a really simple
Gatsby Site with one page that uses ‚Äúfetch‚Äù to, er fetch and then render the data.</p>
<p>I‚Äôve used <a href="https://theme-ui.com/home">Theme UI</a> for the style but naturally you can choose whatever you like to do this.</p>
<p>Whether you‚Äôre starting from scratch or adding Netlify Functions to an existing project you‚Äôll need to start by adding a
<code>functions</code> dir to the root of your project.</p>
<pre class="language-sh"><code is:raw="" class="language-sh"><span class="token operator">|</span>-- functions
  <span class="token operator">|</span>-- package.json
<span class="token operator">|</span>-- src
package.json</code></pre>
<p><code>functions</code> is kind of it‚Äôs own application so it‚Äôll need it‚Äôs own <code>package.json</code> and will have one dependency on
<a href="https://github.com/HunterLarco/twitter-v2">twitter-v2</a></p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token comment">// ./functions/package.json</span>

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gatsby-netlify-twitter-api&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;An api for the Twitter v2 api&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;twitter-v2&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^0.1.2&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Next have a look at <a href="https://github.com/PaulieScanlon/gatsby-netlify-twitter/blob/main/.env.example">.env.example</a>.
You‚Äôll need to create your own <code>.env</code> file and add the environment variables as seen in the <code>.env.example</code>. Naturally
you‚Äôll want to change the <code>GATSBY_TWITTER_USERNAME</code> to your own Twitter username and the Twitter keys and tokens will be
what I referenced earlier which are provided by the Twitter Developer Portal</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token comment">// ./.env</span>

<span class="token constant">GATSBY_API_URL</span><span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span>netlify<span class="token operator">/</span>functions
<span class="token constant">GATSBY_TWITTER_USERNAME</span><span class="token operator">=</span>

<span class="token constant">TWITTER_API_KEY</span><span class="token operator">=</span>
<span class="token constant">TWITTER_API_KEY_SECRET</span><span class="token operator">=</span>
<span class="token constant">TWITTER_ACCESS_TOKEN</span><span class="token operator">=</span>
<span class="token constant">TWITTER_ACCESS_TOKEN_SECRET</span><span class="token operator">=</span>
</code></pre>
<p>Next create a Twitter client, this is what we‚Äôll use to pass the keys and tokens onto the Twitter API when we make a
request</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token comment">// ./functions/client.js</span>

<span class="token keyword">const</span> Twitter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;twitter-v2&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">client</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Twitter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">consumer_key</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TWITTER_CONSUMER_KEY</span><span class="token punctuation">,</span>
    <span class="token literal-property property">consumer_secret</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TWITTER_CONSUMER_KEY_SECRET</span><span class="token punctuation">,</span>
    <span class="token literal-property property">access_token</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TWITTER_ACCESS_TOKEN</span><span class="token punctuation">,</span>
    <span class="token literal-property property">access_token_secret</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TWITTER_ACCESS_TOKEN_SECRET</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>You should now be looking at something similar to the below</p>
<pre class="language-sh"><code is:raw="" class="language-sh"><span class="token punctuation">..</span>.
<span class="token operator">|</span>-- functions
  <span class="token operator">|</span>-- client.js
  <span class="token operator">|</span>-- package.json
<span class="token operator">|</span>-- src
package.json
.env
<span class="token punctuation">..</span>.</code></pre>
<p>Now we need to create the ‚Äúendpoint‚Äù that our frontend will hit, which in turn goes off and grabs the data from the
Twitter API.</p>
<p>I created a dir called <code>twitter-user</code> and inside I create a new file and called it <code>twitter-user.js</code></p>
<pre class="language-sh"><code is:raw="" class="language-sh"><span class="token punctuation">..</span>.
<span class="token operator">|</span>-- functions
  <span class="token operator">|</span>-- client.js
  <span class="token operator">|</span>-- twitter-user
    <span class="token operator">|</span>-- twitter-user.js
  <span class="token operator">|</span>-- package.json
<span class="token operator">|</span>-- src
package.json
.env
<span class="token punctuation">..</span>.</code></pre>
<p>It‚Äôs in here where we can use the <code>client.js</code> to hit a Twitter API endpoint and pass with it the required keys and
tokens from the <code>client</code></p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token comment">// ./functions/twitter-user/twitter-user.js</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;../client&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> context<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">users/by/username/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_TWITTER_USERNAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">fields</span><span class="token operator">:</span>
        <span class="token string">&#39;created_at,description,entities,id,location,name,pinned_tweet_id,profile_image_url,protected,public_metrics,url,username,verified,withheld&#39;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&#39;Access-Control-Allow-Origin&#39;</span><span class="token operator">:</span> <span class="token string">&#39;*&#39;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">statusCode</span><span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">user</span><span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>In the above you can see we use our <code>client</code> to hit the <code>users/by/username</code> Twitter API endpoint which you can read more
about <a href="https://developer.twitter.com/en/docs/twitter-api/users/lookup/introduction">here</a>, which returns a <code>data</code> object
which I pass on to the callback body as <code>{ user: data }</code></p>
<p>This is the object that‚Äôll we receive in our frontend</p>
<p>The next bit will greatly depend on how you‚Äôve set up your frontend but in the
<a href="https://github.com/PaulieScanlon/gatsby-netlify-twitter/blob/main/src/pages/index.js">Demo</a> I have one <code>page</code> called
<code>index.js</code> which uses a <code>useEffect</code> to ‚Äúfetch‚Äù the data from the Netlify Function.</p>
<p>The example file contains a few extra bits for <code>isLoading</code> and <code>hasError</code> but the below should be enough to allow you
hit to the Netlify Function which in turn hits the Twitter API and returns your profile information data.</p>
<pre class="language-javascript"><code is:raw="" class="language-javascript"><span class="token comment">// ./src/pages/index.js</span>

<span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">IndexPage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>response<span class="token punctuation">,</span> setResponse<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">GATSBY_API_URL</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/twitter-user</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setResponse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">user</span><span class="token operator">:</span> response<span class="token punctuation">.</span>user <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">{</span> error <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>pre<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>code<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> IndexPage<span class="token punctuation">;</span></code></pre>
<p><code>process.env.GATSBY_API_URL</code> is the path to the Netlify Function we added earlier to <code>.env</code> and i‚Äôve hard-coded
<code>/twitter-user</code> in the component / page as you might want to create different endpoints that return different data on
different pages.</p>
<p>You might be wondering why this environment variable is prefixed with <code>GATSBY_</code>. This is so Gatsby can access it from
the frontend. You can read more about Gatsby environment variables
<a href="https://www.gatsbyjs.com/docs/environment-variables/#client-side-javascript">here</a></p>
<h3 id="important">IMPORTANT</h3>
<p>In order for Netlify Functions to work both locally and when deployed we need to ensure we‚Äôve got <code>netlify-lambda</code>
installed and have added both a <code>&quot;start&quot;</code> and <code>&quot;postinstall&quot;</code> script to the root <code>package.json</code> (not the <code>package.json</code>
in <code>./functions</code>)</p>
<pre class="language-sh"><code is:raw="" class="language-sh"><span class="token function">npm</span> <span class="token function">install</span> netlify-lambda <span class="token parameter variable">--save</span> <span class="token parameter variable">-dev</span></code></pre>
<pre class="language-diff"><code is:raw="" class="language-diff">// ./package.json

...
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &quot;scripts&quot;: {
</span><span class="token prefix unchanged"> </span><span class="token line">   &quot;develop&quot;: &quot;gatsby develop&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &quot;build&quot;: &quot;gatsby build&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &quot;clean&quot;: &quot;gatsby clean&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">   &quot;serve&quot;: &quot;gatsby serve&quot;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &quot;start&quot;: &quot;npm run develop&quot;,
</span><span class="token prefix inserted">+</span><span class="token line">    &quot;postinstall&quot;: &quot;netlify-lambda install&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line">  &quot;devDependencies&quot;: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   &quot;netlify-lambda&quot;: &quot;^1.6.3&quot;,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>...
</code></pre>
<p>Before we get too carried away, it‚Äôs important to note that we‚Äôll no longer be using <code>gatsby develop</code> or <code>yarn develop</code>
to start the Gatsby app, if you do that our Netlify Function won‚Äôt be running and you‚Äôll get an error.</p>
<p>Instead, run <code>netlify dev</code> this is so both the Gatsby site and the Netlify Function are run at the same time.</p>
<p>Instead of visiting the usual <code>http://localhost:8000/</code> we‚Äôll now be visiting <code>http://localhost:8888/</code></p>
<p>And to ensure when we deploy everything works as it should you‚Äôll need to modify your
<a href="https://github.com/PaulieScanlon/gatsby-netlify-twitter/blob/main/netlify.toml"><code>netlify.toml</code></a></p>
<p>For the most part <code>netlify dev</code> will attempt to automatically determine which static site generator you‚Äôre using by
looking for certain files in the project root. If you don‚Äôt already have a <code>gatsby-config.js</code> at the root of your
project add one as i‚Äôve done
<a href="https://github.com/PaulieScanlon/gatsby-netlify-twitter/blob/main/gatsby-config.js">here</a>‚Ä¶ you might not want to use
Theme UI so ignore that if you‚Äôre using some other CSS method.</p>
<p>As mentioned above Netlify Functions are kind of their own application so when you deploy this to Netlify we need to
ensure that the dependencies get installed, and you tell Netlify where the <code>functions</code> are in the directory structure</p>
<p>You‚Äôll also need to ensue you‚Äôve added all the same <code>.env</code> variables to the Netlify environment. Have a look in your
Site settings and find ‚ÄúEnvironment‚Äù under ‚ÄúBuild &amp; Deploy‚Äù</p>
<p>Also make sure you‚Äôve correctly set the ‚ÄúSensitive variable policy‚Äù I just set mine as ‚ÄúDeploy without restrictions‚Äù
because i‚Äôm edgy!</p>
<pre class="language-diff"><code is:raw="" class="language-diff">// ./netlify.toml

[build]
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  command = &quot;yarn build&quot;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  command = &quot;yarn build &amp;&amp; cd functions &amp;&amp; yarn&quot;
</span><span class="token prefix inserted">+</span><span class="token line">  functions = &quot;functions&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> publish = &quot;public/</span></span></code></pre>
<p>With all that set you should be able to run <code>netlify dev</code> visit <code>http://localhost:8888/</code> and see your own Twitter data
rendered on the page, and once you deploy you ‚Äúshould‚Äù find everything continues to work as it did locally.</p>
<p>I‚Äôm not 100% on this but I think you might have to deploy at least once just so <code>netlify dev</code> knows where the functions
are‚Ä¶ it‚Äôs a bit weird even though you‚Äôre developing locally, however it seems to error until you deploy at least once.</p>
<p>Fingers crossed this is enough to get you up and running with Netlify Functions, but if you feel like any of this is a
bit ‚Äù<a href="https://www.reddit.com/r/restofthefuckingowl/">draw the rest of the fucking owl</a>‚Äù feel free to find me on Twitter.</p><aside class="fixed top-[4.6rem] bottom-0 right-[max(0px,calc(50%-45rem))] w-[19.5rem] py-6 px-8 overflow-y-auto hidden xl:flex flex-col gap-8 z-10"><div class="grid gap-4 rounded border border-brand-outline bg-brand-surface/50 px-4 sm:px-6 py-6"><div class="rounded shadow-lg overflow-hidden w-full"><img src="https://res.cloudinary.com/www-paulie-dev/image/upload/v1605613346/paulie.dev/2020/11/gatsby-netlify-twitterjpg_ok1k0q.jpg" alt="Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog" class="m-0" width="240" height="135" loading="lazy" decoding="async"></div><a href="https://twitter.com/intent/tweet?text=Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog
 https://paulie.dev/posts/2020/11/gatsby-netlify-twitter/" target="_blank" rel="noreferrer" class="not-prose flex items-center justify-center gap-4 no-underline text-brand-secondary text-sm text-center py-2 px-4 transition-all duration-300 rounded border border-brand-outline bg-brand-surface hover:text-brand-text hover:bg-brand-muted/20"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
Share on X
</a></div><div class="px-2"><h5 class="font-semibold uppercase text-brand-secondary">on this page</h5><ul class="list-none m-0 p-0"><li class="m-0 py-0 pl-4"><a href="#a-rather-unique-requirement" class="text-xs p-1 no-underline text-violet-300">A rather unique requirement</a></li><li class="m-0 py-0 pl-4"><a href="#demo" class="text-xs p-1 no-underline text-violet-300">Demo</a></li><li class="m-0 py-0 pl-4"><a href="#tech" class="text-xs p-1 no-underline text-violet-300">Tech</a></li><li class="m-0 py-0 pl-6"><a href="#netlify-functions" class="text-xs p-1 no-underline text-violet-300">Netlify Functions</a></li><li class="m-0 py-0 pl-6"><a href="#twitter-api-v2" class="text-xs p-1 no-underline text-violet-300">Twitter API v2</a></li><li class="m-0 py-0 pl-4"><a href="#before-we-start" class="text-xs p-1 no-underline text-violet-300">Before we start</a></li><li class="m-0 py-0 pl-6"><a href="#twitter-api-v2-1" class="text-xs p-1 no-underline text-violet-300">Twitter API v2</a></li><li class="m-0 py-0 pl-6"><a href="#netlify-cli" class="text-xs p-1 no-underline text-violet-300">Netlify CLI</a></li><li class="m-0 py-0 pl-4"><a href="#the-build" class="text-xs p-1 no-underline text-violet-300">The Build</a></li><li class="m-0 py-0 pl-6"><a href="#important" class="text-xs p-1 no-underline text-violet-300">IMPORTANT</a></li></ul></div></aside></article></section></main></div></div></body></html>